<template>
  <require from="./header-selector.html"></require>
  <require from="./cell-selector.html"></require>
  <require from="./no-items-area.html"></require>

  <table class="table is-striped is-hoverable is-fullwidth">
    <thead>
      <tr>
        <th width="0px" show.bind="options.selection">
          <header-selector
            row.bind="_headerRow"
            change.delegate="_selectAllRows($event)"
          ></header-selector>
        </th>
        <th repeat.for="column of _columns">
          <a
            click.delegate="_headerClicked({ $event, column })"
            class="has-text-dark"
          >
            ${column.header.name || column.header}
            <span show.bind="column.sort" class="icon is-small is-right">
              <span show.bind="column.sort.direction === 'asc'">&#9660;</span>
              <span show.bind="column.sort.direction === 'desc'">&#9650;</span>
            </span>
          </a>
        </th>
      </tr>
    </thead>
    <tbody>
      <tr
        repeat.for="row of rows | phdSort:_sorts | phdPage:page.size:page.pageNumber"
        class="${options.selection.highlightOnSelect && row.selected ? 'is-selected' : ''}"
      >
        <td show.bind="options.selection">
          <cell-selector
            row.bind="row"
            index.bind="$index"
            change.delegate="_rowSelectionChanged($event, [ row ])"
          ></cell-selector>
        </td>
        <td
          repeat.for="column of _columns"
          class="${column.className}"
          click.capture="_cellClicked($event, { row })"
        >
          <span
            if.bind="column.renderer"
            style.bind="column.style"
            enhance-html="${column.renderer({ item: row.item })}"
          ></span>
          <span else>${_getFieldData(row.item, column)}</span>
        </td>
      </tr>
    </tbody>
  </table>

  <div show.bind="!rows.length">
    <no-items-area></no-items-area>
  </div>
</template>
